<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>COMMAND_LIST</key>
	<array>
		<dict>
			<key>ACTIVATION_MODE</key>
			<string>act_folder</string>
			<key>COMMAND</key>
			<array>
				<string># env | sort
echo "${OMC_ACTIONUI_WINDOW_UUID}"
				</string>
			</array>
			<key>EXECUTION_MODE</key>
			<string>exe_shell_script</string>
			<key>NAME</key>
			<string>Form</string>
			<key>ACTIONUI_WINDOW</key>
			<dict>
				<key>END_CANCEL_SUBCOMMAND_ID</key>
				<string>form.dialog.terminate.cancel</string>
				<key>INIT_SUBCOMMAND_ID</key>
				<string>form.dialog.init</string>
				<key>IS_BLOCKING</key>
				<false/>
				<key>JSON_NAME</key>
				<string>Form</string>
			</dict>
			<key>NOTES</key>
			<string>ActionUI json window test</string>
			<key>REQUIRED_MAC_OS_MIN_VERSION</key>
			<string>14.6</string>
			<key>REQUIRED_OMC_VERSION</key>
			<string>5.0</string>
			<key>VERSION</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>COMMAND</key>
			<array>
				<string>dialog_tool="$OMC_OMC_SUPPORT_PATH/omc_dialog_control"
"$dialog_tool" "$OMC_ACTIONUI_WINDOW_UUID" 2 "Papa Smurf"
# Exercise omc_dialog_control operations (tests setControlValues: abstract methods)
"$dialog_tool" "$OMC_ACTIONUI_WINDOW_UUID" 2 omc_enable
"$dialog_tool" "$OMC_ACTIONUI_WINDOW_UUID" 2 omc_show
"$dialog_tool" "$OMC_ACTIONUI_WINDOW_UUID" omc_window omc_select

# Exercise omc_set_property: disable Save button (id 7) and hide SecureField (id 3)
# Visual check during tests: Save should be greyed out, password field should disappear
"$dialog_tool" "$OMC_ACTIONUI_WINDOW_UUID" 7 omc_set_property "disabled" true
"$dialog_tool" "$OMC_ACTIONUI_WINDOW_UUID" 3 omc_set_property "hidden" true

# Write diagnostic file atomically
init_file="/tmp/OMC_test_actionui_init_${OMC_ACTIONUI_WINDOW_UUID}"
init_tmp="${init_file}.tmp"
echo "INIT_COMPLETE=YES" > "$init_tmp"
echo "OMC_ACTIONUI_WINDOW_UUID=${OMC_ACTIONUI_WINDOW_UUID}" >> "$init_tmp"
echo "OMC_OBJ_PATH=${OMC_OBJ_PATH}" >> "$init_tmp"
echo "OMC_OMC_SUPPORT_PATH=${OMC_OMC_SUPPORT_PATH}" >> "$init_tmp"
echo "SET_PROPERTY_COMPLETE=YES" >> "$init_tmp"
mv "$init_tmp" "$init_file"

# uncomment the line below to show the window with environment variables
# "$OMC_OMC_SUPPORT_PATH/omc_next_command" "$OMC_CURRENT_COMMAND_GUID" "form.dialog.show.env"
				</string>
			</array>
			<key>COMMAND_ID</key>
			<string>form.dialog.init</string>
			<key>EXECUTION_MODE</key>
			<string>exe_shell_script</string>
			<key>NAME</key>
			<string>Form</string>
		</dict>
		<dict>
			<key>COMMAND</key>
			<array>
				<string>env | sort</string>
			</array>
			<key>COMMAND_ID</key>
			<string>form.dialog.show.env</string>
			<key>EXECUTION_MODE</key>
			<string>exe_shell_script_with_output_window</string>
			<key>NAME</key>
			<string>Form</string>
			<key>OUTPUT_WINDOW_SETTINGS</key>
			<dict>
				<key>TEXT_FONT</key>
				<string>Monaco</string>
				<key>TEXT_SIZE</key>
				<integer>10</integer>
				<key>WINDOW_HEIGHT</key>
				<integer>600</integer>
				<key>WINDOW_POSITION</key>
				<string>alert</string>
				<key>WINDOW_TYPE</key>
				<string>floating</string>
				<key>WINDOW_WIDTH</key>
				<integer>900</integer>
			</dict>
			<key>ENVIRONMENT_VARIABLES</key>
			<dict>
				<key>CUSTOM_VAR</key>
				<string>form</string>
			</dict>
		</dict>
		<dict>
			<key>COMMAND</key>
			<array>
				<string>echo "form.save: name=${OMC_ACTIONUI_VIEW_2_VALUE}"
				</string>
			</array>
			<key>COMMAND_ID</key>
			<string>form.save</string>
			<key>EXECUTION_MODE</key>
			<string>exe_shell_script</string>
			<key>NAME</key>
			<string>Form</string>
		</dict>
		<dict>
			<key>COMMAND</key>
			<array>
				<string>echo "form.cancel"
				</string>
			</array>
			<key>COMMAND_ID</key>
			<string>form.cancel</string>
			<key>EXECUTION_MODE</key>
			<string>exe_shell_script</string>
			<key>NAME</key>
			<string>Form</string>
		</dict>
		<dict>
			<key>ACTIVATION_MODE</key>
			<string>act_selected_text</string>
			<key>COMMAND</key>
			<array>
				<string>WINDOW_UUID="${OMC_OBJ_TEXT}"
if [ -n "${WINDOW_UUID}" ]; then
    "$OMC_OMC_SUPPORT_PATH/omc_dialog_control" "$WINDOW_UUID" omc_window omc_terminate_cancel
fi
env | sort
				</string>
			</array>
			<key>COMMAND_ID</key>
			<string>form.close.window</string>
			<key>EXECUTION_MODE</key>
			<string>exe_shell_script</string>
			<key>NAME</key>
			<string>Form</string>
			<key>NOTES</key>
			<string>Test command designed to receive OMC_ACTIONUI_WINDOW_UUID from text context</string>
		</dict>
		<dict>
			<key>ACTIVATION_MODE</key>
			<string>act_selected_text</string>
			<key>COMMAND</key>
			<array>
				<string>WINDOW_UUID="${OMC_OBJ_TEXT}"
if [ -n "${WINDOW_UUID}" ]; then
    "$OMC_OMC_SUPPORT_PATH/omc_dialog_control" "$WINDOW_UUID" omc_window omc_invoke close
fi
				</string>
			</array>
			<key>COMMAND_ID</key>
			<string>form.invoke.close</string>
			<key>EXECUTION_MODE</key>
			<string>exe_shell_script</string>
			<key>NAME</key>
			<string>Form</string>
			<key>NOTES</key>
			<string>Test command: close window via INVOKE instead of omc_terminate_cancel</string>
		</dict>
		<dict>
			<key>COMMAND</key>
			<array>
				<string>term_file="/tmp/OMC_test_actionui_term_${OMC_ACTIONUI_WINDOW_UUID}"
term_tmp="${term_file}.tmp"
echo "TERM_COMPLETE=YES" > "$term_tmp"
echo "OMC_ACTIONUI_WINDOW_UUID=${OMC_ACTIONUI_WINDOW_UUID}" >> "$term_tmp"
echo "VIEW_2_VALUE=${OMC_ACTIONUI_VIEW_2_VALUE}" >> "$term_tmp"
mv "$term_tmp" "$term_file"
				</string>
			</array>
			<key>COMMAND_ID</key>
			<string>form.dialog.terminate.cancel</string>
			<key>EXECUTION_MODE</key>
			<string>exe_shell_script</string>
			<key>NAME</key>
			<string>Form</string>
		</dict>
	</array>
	<key>VERSION</key>
	<integer>2</integer>
</dict>
</plist>
